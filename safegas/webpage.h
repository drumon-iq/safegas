/*
* "front end" LOL
*/

//#define webpage "<html><head><metacharset='UTF-8'><metaname='viewport' content='width=device-width'><title>SafeGas</title><linkrel='stylesheet' href='style.css'></head><body><h2>SafeGas</h2><br><a href='/amongos'>close valve</a></body></html>"
#define webpage "<!DOCTYPE HTML> <html> <head> <meta charset='UTF-8'> <meta name='viewport' content='width=device-width'> <title>SafeGas</title> <style> a { text-decoration:none; color:white; } main { display:flex; align-items:center; flex-direction:column } #divB { border: solid black; width:200px; padding: 20px 0 20px 0; text-align:center; background-color:grey; margin:80px; } #warning { color:red; visibility:hidden; background-color:Bisque; padding:10px; text-align:center; border: solid DarkSalmon; } </style> </head> <body> <h2 id='warning'>No connection avaible</h2> <main> <h2>SafeGas</h2> <div id='divB'> <a id='valveBut' href='/toggleValve' style=''> undefined </a> </div> <details> <summary>Detalhes e configurações</summary> <ul> <li id='gas'>Gas value: Not defined</li> <li id='flame'>Flame value: Not defined</li> </ul> </details> </main> <script defer> const apiUrl = 'http://192.168.4.1/'; const warning = document.getElementById('warning'); const gasItem = document.getElementById('gas'); const flameItem = document.getElementById('flame'); const valveB = document.getElementById('valveBut'); async function getData(url) { try { const response = await fetch(url); warning.style.visibility = 'hidden'; return await response.text(); } catch (error) { warning.style.visibility = 'visible'; return 'connection failed'; } } setInterval(() => { getData(apiUrl + 'gasValue').then( function(res) { gasItem.innerText = 'Gas value: ' + res; }); getData(apiUrl + 'flameValue').then( function(res) { flameItem.innerText = 'Flame value: ' + res; }); getData(apiUrl + 'valveValue').then( function(res) { if (res === '1') { valveB.innerText = 'Abrir Valvula'; } else { valveB.innerText = 'Fechar Valvula'; } }); }, 1000); </script> </body> </html>"
